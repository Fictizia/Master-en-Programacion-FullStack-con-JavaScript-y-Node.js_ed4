<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: javascript.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: javascript.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
/**
 * @file exercise to get photos of the curiosity robot from Mars
 * @author Miguel Martin-Maestro Lopez
 * @version 1.0.0
 * @description you need to get the api key from NASA API in https://api.nasa.gov/index.html#apply-for-an-api-key
 */
const token = "";

/**
 * @description the parameters must be entered in the async function below
 * @param {number} soles number of the sun we want information (sun are the Martian days)
 * @param {number} limit limit number to not exceed the number of calls
 * @returns robot data
 */
function NasaRequest(soles,limit){
  return new Promise((resolve, reject) => {     
    var url = "https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?sol=" + soles + "&amp;api_key=" + token; 

    if(limit>0){
      fetch(url)
      .then((response) => {
        if(response.ok){
          response.json()
          .then((data) => {          
            if(data.photos.length == 0){
              console.log(data);
              console.log("Este sol no tiene información, pasando al siguiente sol...");
              setTimeout(() => resolve(NasaRequest(soles-1,limit-1)), 1000)              
            }else{
              console.log("AQUI SI !");
              console.log(data);              
              resolve(data);              
            }
          })
        }else{
          reject("Error en la llamada.");
        }                 
      });
    }else{
       console.log("Límite de llamadas superado, intentelo de nuevo.")
    };  
  });
}; 

async function init(){  
  const currentValue = await NasaRequest(2205,15);
  console.log("currentValue:", currentValue);
  document.getElementById("resultado").querySelector("img").src = currentValue.photos[0].img_src;
}
init();




</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#NasaRequest">NasaRequest</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Mon Jan 20 2020 23:25:39 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
